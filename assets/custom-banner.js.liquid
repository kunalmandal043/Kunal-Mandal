// Mobile menu implementation with better error handling
(function() {
  // Initialize when DOM is ready
  function initMobileMenu() {
    const menuToggle = document.getElementById('mobile-menu-toggle');
    const mobileDropdown = document.getElementById('mobile-dropdown');
    
    if (!menuToggle || !mobileDropdown) {
      console.error('Mobile menu elements not found');
      return;
    }
    
    const menuIcon = menuToggle.querySelector('.menu-icon');
    const closeIcon = menuToggle.querySelector('.close-icon');
    const body = document.body;
    
    // Toggle menu function
    function toggleMenu() {
      const isOpen = mobileDropdown.classList.contains('active');
      
      if (isOpen) {
        // Close menu
        mobileDropdown.classList.remove('active');
        if (menuIcon) menuIcon.style.display = 'block';
        if (closeIcon) closeIcon.style.display = 'none';
        body.classList.remove('mobile-menu-open');
      } else {
        // Open menu
        mobileDropdown.classList.add('active');
        if (menuIcon) menuIcon.style.display = 'none';
        if (closeIcon) closeIcon.style.display = 'block';
        body.classList.add('mobile-menu-open');
      }
    }
    
    // Add click event to menu toggle
    menuToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      toggleMenu();
    });
    
    // Close menu when clicking on the overlay (outside content)
    mobileDropdown.addEventListener('click', function(e) {
      if (e.target === mobileDropdown) {
        toggleMenu();
      }
    });
    
    // Close menu when pressing Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && mobileDropdown.classList.contains('active')) {
        toggleMenu();
      }
    });
  }
  
  // Run initialization when DOM is loaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMobileMenu);
  } else {
    // DOM is already ready
    initMobileMenu();
  }
})();
