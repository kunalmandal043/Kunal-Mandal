{{ 'custom-grid.css' | asset_url | stylesheet_tag }}
<script src="{{ 'custom-grid.js' | asset_url }}" defer></script>

{% assign all_products_collection = collections['all-products'] %}

<section class="custom-grid">
  <h2 class="heading">Tisso vision in the wild</h2>
  <div class="grid-container">
    {% for product in all_products_collection.products %}
      <div class="grid-item" data-handle="{{ product.handle }}">
        <div class="grid-image-wrapper">
          {% if product.featured_image %}
            <img 
              src="{{ product.featured_image | image_url: width: 433, height: 444, crop: 'center' }}" 
              alt="{{ product.title }}" 
              width="433" 
              height="444"
              class="grid-image"
              loading="lazy"
            >
          {% else %}
            <img 
              src="{{ 'placeholder.png' | asset_url }}" 
              alt="Placeholder" 
              width="433" 
              height="444"
              class="grid-image"
              loading="lazy"
            >
          {% endif %}

          <!-- Popup icon -->
          <img 
            class="popup-icon" 
            src="{{ 'circle-popup.svg' | asset_url }}" 
            alt="Open Popup" 
            width="22" 
            height="22"
          >
        </div>
      </div>
    {% endfor %}
  </div>
</section>

<!-- Product Popup -->
<div id="product-popup" class="popup hidden" 
     data-placeholder="{{ 'placeholder.png' | asset_url }}"
     data-arrow-lower="{{ 'choose-size-lower.svg' | asset_url }}"
     data-arrow-upper="{{ 'choose-size-upper.svg' | asset_url }}">
  <div class="popup-content" role="dialog" aria-modal="true" aria-labelledby="popup-title">
    <button id="popup-close" aria-label="Close popup">&times;</button>

    <!-- Top section: Image + Details -->
    <div class="popup-top">
      <img id="popup-image" src="{{ 'placeholder.png' | asset_url }}" alt="Product preview" width="400" height="400" loading="lazy">

      <div class="popup-details">
        <h2 id="popup-title"></h2>
        <p id="popup-price"></p>
        <div id="popup-description"></div>
      </div>
    </div>

    <!-- Bottom section: Options + Add to Cart -->
    <div class="popup-bottom">
      <div class="popup-option" id="color-option-container" style="display:none;">
        <label for="color-select">Color:</label>
        <select id="color-select" style="display:none;"></select>
        <div id="color-swatches" class="color-swatches"></div>
      </div>

      <div class="popup-option" id="size-option-container" style="display:none;">
        <label for="size-select">Size:</label>
        <div class="size-select-wrapper">
          <select id="size-select" required>
            <option value="" disabled hidden selected>Choose your size</option>
            <option value="S">S</option>
            <option value="M">M</option>
          </select>
          <img class="size-arrow" 
          src="{{ 'choose-size-lower.svg' | asset_url }}" 
          alt="Dropdown arrow"
          width="16" 
          height="16">
        </div>
      </div>

      <button id="add-to-cart">
        <img class="add-to-cart-icon" 
          src="{{ 'add-to-cart.svg' | asset_url }}" 
          alt="Add to Cart"
          width="" 
          height="">
        
      </button>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Custom Grid",
  "settings": [],
  "blocks": [],
  "presets": [
    {
      "name": "Custom Grid"
    }
  ]
}
{% endschema %}
